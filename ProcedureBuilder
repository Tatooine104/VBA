

' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Имя:          Testing
' Описание:     Методы для работы создателя процедур
' Тип:          UserForm
' Создано:      03.04.2020 20:24:45
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Обновлено:    2020.04.05 20:03:53 Шевченко    Создание параметров исправлены сковки на фигурные вокруг типа и оптимизировано создание необязательного параметра
' Обновлено:    2020.02.28 11:22:07 dmitry.shevchenko: Исправлена логика формирования имени создаваемого метода без указанного префикса
' Обновлено:    2020.04.08 17:48:12 dmitry.shevchenko   Добавлен метод [sc_Pattern_Refresh_Table] - Применить паттерн "Обновить таблицу"
' Обновлено:    2020.04.08 18:07:54 dmitry.shevchenko   Добавлен метод [sc_Pattern_Manupulate_Data] - Дополнить строку кода паттерном манимуляции данных
' Обновлено:    2020.04.09 07:56:11 dmitry.shevchenko   Добавлен метод [sc_VBA_Add_Line] - Добавить строку
' Обновлено:    2020.04.10 18:11:24 dmitry.shevchenko   Добавлен метод [sc_Symbols_Check] - Проверка текста на запрещенные символы
' Обновлено:    2020.04.12 07:54:55 dmitry.shevchenko   Добавлен метод [fn_Check_Array] - Проверка является ли переменная массивом
' Обновлено:    2020.04.09 09:39:11 dmitry.shevchenko   Добавлен метод [OptionProperty_Click] - Обработка события выбора опции
' Обновлено:    2020.04.12 08:39:21 dmitry.shevchenko   Добавлен метод [ArrayMark_Change] - Обработка события выбора возврата массива
' Обновлено:    2020.04.12 08:41:49 dmitry.shevchenko   Добавлен метод [ExitOption_Click] - Обработка события выбора выхода из процедуры при ошибке
' Обновлено:    2020.04.12 08:43:40 dmitry.shevchenko   Добавлен метод [LoggerOption_Click] - Обработка события выбора логирования ошибки
' Обновлено:    2020.04.12 08:46:59 dmitry.shevchenko   Добавлен метод [ResumeOption_Click] - Обработка события выбора продоолжения работы при ошибке
' Обновлено:    2020.04.12 08:48:47 dmitry.shevchenko   Добавлен метод [TitlesLetters_Change] - Обработка события изменения метки проверки заглавных букв
' Обновлено:    2020.04.12 08:51:27 dmitry.shevchenko   Добавлен метод [TypePreFixCheck_Change] - Обработка события изменения метки префика типа процедуры
' Обновлено:    2020.04.12 09:14:23 dmitry.shevchenko   Добавлен метод [CodeListing_DblClick] - Обработка события - двойного клика на поле сгенерированного кода
' Обновлено:    2020.04.12 09:17:08 dmitry.shevchenko   Добавлен метод [CreateParametr_Click] - Обработка события нажатия на кнопку "Создать параметр"
' Обновлено:    2020.04.12 09:23:33 dmitry.shevchenko   Добавлен метод [ErrorHandlerMark_Change] - Обработка события изменения метки обработки ошибок
' Обновлено:    2020.04.12 09:25:16 dmitry.shevchenko   Добавлен метод [OptionFunction_Change] - Обработка события выбора типа "Функция"
' Обновлено:    2020.04.12 09:27:37 dmitry.shevchenko   Добавлен метод [ParametrArrayMark_Change] - Обработка события изменения метки массива Параметра
' Обновлено:    2020.04.12 09:29:09 dmitry.shevchenko   Добавлен метод [ParametrByVal_Change] - Обработка события выбора пердачи парметра по значению
' Обновлено:    2020.04.12 09:30:51 dmitry.shevchenko   Добавлен метод [OptionPrivate_Change] - Обработка события выбора уровня доступа "Private"
' Обновлено:    2020.04.12 09:32:46 dmitry.shevchenko   Добавлен метод [OptionPublic_Change] - Обработка события выбора уровня доступа "Public"
' Обновлено:    2020.04.12 09:37:01 dmitry.shevchenko   Добавлен метод [OptionSub_Change] - Обработка события выбора типа создаваемого метода = "Sub"
' Обновлено:    2020.04.12 09:38:49 dmitry.shevchenko   Добавлен метод [ParametrName_Change] - Обработка события изменения имени создаваемого метода
' Обновлено:    2020.04.12 09:41:55 dmitry.shevchenko   Добавлен метод [PatternChoice_Change] - Обработка события выбора шаблона кода
' Обновлено:    2020.04.12 09:48:28 dmitry.shevchenko   Добавлен метод [ProcedureInfo_Change] - Обработка события изменения описания к создаваемому методу
' Обновлено:    2020.04.12 09:50:27 dmitry.shevchenko   Добавлен метод [ProcedureName_Change] - Процедура обработки события изменения имени создаваемой процедуры
' Обновлено:    2020.04.12 09:52:45 dmitry.shevchenko   Добавлен метод [ReturnInfo_Change] - Обработка события изменения описания к возвращзаемому значению
' Обновлено:    2020.04.12 09:56:28 dmitry.shevchenko   Добавлен метод [ReturnType_Change] - Обработка изменения типа возвращаемого значения
' Обновлено:    2020.04.12 09:58:40 dmitry.shevchenko   Добавлен метод [ScreenUpdatingMark_Change] - Обработка события выбора метки обновления экрана
' Обновлено:    2020.04.12 10:01:16 dmitry.shevchenko   Добавлен метод [UserForm_Activate] - Обработка события активации формы генерации методов
' Обновлено:    2020.04.12 10:04:26 dmitry.shevchenko   Добавлен метод [sc_Code_Listing_Create] - Метод генерации методов
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Option Explicit
Private Const MODULEVERSION As Double = 1.032 ' Номер версии модуля
Private Parametrs() As String  ' Массив хранящий список параметров
Private ParametrsInd As Long  ' Индекс создаваемого параметра

' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.08 17:48:02
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     sc_Pattern_Refresh_Table
' Тип:          Sub
' Доступ:       Private
' Описание:     Применить паттерн "Обновить таблицу"
' Параметр:     r_strCode {String} - Строка кода которую нужно дополнить паттерном
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub sc_Pattern_Refresh_Table(ByRef r_strCode As String)

On Error GoTo sc_Pattern_Refresh_Table_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
    
    If temp_ThisSheet.Value = "" Then temp_ThisSheet.Value = InputBox("Введите имя листа на который должен перейти скрипт в конце обновления")
    If temp_DataSheet.Value = "" Then temp_DataSheet.Value = InputBox("Введите имя листа на котором расположена обновляемая таблица")
    If temp_OptionName.Value = "" Then temp_OptionName.Value = InputBox("Введите название опции")
    
    Call sc_VBA_Add_Line(r_strCode, vbNewLine & vbTab & temp_Name.Caption & " = False ' Значение по умолчанию")
    Call sc_VBA_Add_Line(r_strCode, vbNewLine & vbTab & "Dim ThisSheet as WorkSheet: Set ThisSheet = Worksheets(" & Chr(34) & temp_ThisSheet.Value & Chr(34) & ") ' Лист на который вернуться скрипт когда закончит")
    Call sc_VBA_Add_Line(r_strCode, vbTab & "Dim DataSheet as WorkSheet: Set DataSheet = Worksheets(" & Chr(34) & temp_DataSheet.Value & Chr(34) & ")  ' Лист на котором находится таблица которую нужно обновить")
    Call sc_VBA_Add_Line(r_strCode, vbTab & "Dim DataTable as String: DataTable = " & Chr(34) & Chr(34) & " ' Имя таблицы которую нужно обновить")
    Call sc_VBA_Add_Line(r_strCode, vbTab & "Dim OptionName as String: OptionName = " & Chr(34) & temp_OptionName.Value & Chr(34) & " ' Название опции которая хранит статус обновления")
    Call sc_VBA_Add_Line(r_strCode, vbTab & "Dim CheckRefresh As Boolean: CheckRefresh = Globals.fn_Refresh_Data(DataSheet, DataTable, OptionName) ' Обновление таблицы")
    Call sc_VBA_Add_Line(r_strCode, vbNewLine & vbTab & "If CheckRefresh Then ' Проверка что таблица действительно обновилась")
    Call sc_VBA_Add_Line(r_strCode, vbNewLine & vbTab & vbTab & "' Здесь необходимо прописать то что нужно сделать с обновленной таблицей. Если что-то делать нужно")
    Call sc_VBA_Add_Line(r_strCode, vbNewLine & vbTab & "End If")
    Call sc_VBA_Add_Line(r_strCode, vbNewLine & vbTab & "ThisSheet.Activate ' Переходим на лист")
    Call sc_VBA_Add_Line(r_strCode, vbNewLine & vbTab & temp_Name.Caption & " = True ' Присваеваем возвращаемое значение")
    Call sc_VBA_Add_Line(r_strCode, vbNewLine & vbTab & "Set ThisSheet = Nothing: Set DataSheet = Nothing ' Очистка памяти")

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

sc_Pattern_Refresh_Table_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "sc_Pattern_Refresh_Table", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.08 18:07:40
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     sc_Pattern_Manupulate_Data
' Тип:          Sub
' Доступ:       Private
' Описание:     Дополнить строку кода паттерном манимуляции данных
' Параметр:     r_strCode {String} - Строка кода которую нужно дополнить паттерном
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub sc_Pattern_Manupulate_Data(ByRef r_strCode As String)

On Error GoTo sc_Pattern_Manupulate_Data_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    If temp_tSheet.Value = "" Then temp_tSheet.Value = InputBox("Введите название листа с которым будем взаимодействовать")
    
    r_strCode = r_strCode & vbNewLine & vbNewLine & vbTab & "ReDim varCols(1) As Variant: varCols = Array(" & Chr(34) & Chr(34) & ") ' Имена столбцов с которыми будем взаимодействовать" & _
                                        vbNewLine & vbTab & "ReDim varCalc(1) As Variant: varCalc = Array(" & Chr(34) & Chr(34) & ") ' Имена расчетных столбцов" & _
                                        vbNewLine & vbTab & "ReDim varForm(1) As Variant: varForm = Array(" & Chr(34) & Chr(34) & ") ' Форматы расчетных столбцов при вставке" & _
                                        vbNewLine & vbTab & "ReDim varTable(1 To UBound(varCols) + 1) As Variant ' Создаем массив для данных с листа" & _
                                        vbNewLine & vbTab & "Dim objSheet As Worksheet: Set objSheet = Worksheets(" & Chr(34) & temp_tSheet.Value & Chr(34) & ") ' Лист с которым будем взаимодействовать" & _
                                        vbNewLine & vbTab & "Dim lonI As Long ' Поле для счетчика цикла" & _
                            vbNewLine & vbNewLine & vbTab & "Call Globals.sc_Data_Manipulate(varTable, objSheet, varCols, varCalc, varForm) ' Подхват данных с листа и отправка их в массив" & _
                            vbNewLine & vbNewLine & vbTab & "For lonI = LBound(varTable(1)) + 1 To UBound(varTable(1)) - 1 ' Перебор строк в массиве" & _
                            vbNewLine & vbNewLine & vbTab & vbTab & "'varTable(Globals.fn_Get_ID(varCols, " & Chr(34) & Chr(34) & "))(lonI, 1)" & _
                            vbNewLine & vbNewLine & vbTab & "Next lonI" & _
                            vbNewLine & vbNewLine & vbTab & "Call Globals.sc_Data_Manipulate(varTable, objSheet, varCols, varCalc, varForm, False, False) ' Вставка данных на лист" & _
                            vbNewLine & vbNewLine & vbTab & "Erase varCols, varTable, varCalc, varForm: Set objSheet = Nothing ' Очистка памяти"

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

sc_Pattern_Manupulate_Data_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "sc_Pattern_Manupulate_Data", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.09 07:56:03
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     sc_VBA_Add_Line
' Тип:          Sub
' Доступ:       Private
' Описание:     Добавить строку
' Параметр:     r_strCode {String} - Строка кода
' Параметр:     strNew {String} - Добавляемая строка
' Параметр:     o_booNewLine {Boolean} - добавлять новую строку или нет
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub sc_VBA_Add_Line(ByRef r_strCode As String, _
                            ByVal strNew As String, _
                            Optional ByVal o_booNewLine As Boolean = True)

On Error GoTo sc_VBA_Add_Line_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    r_strCode = IIf(o_booNewLine, r_strCode & vbNewLine & strNew, r_strCode & strNew)

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

sc_VBA_Add_Line_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "sc_VBA_Add_Line", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.10 18:11:17
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     sc_Symbols_Check
' Тип:          Sub
' Доступ:       Private
' Описание:     Проверка текста на запрещенные символы
' Параметр:     r_strText {String} - Проверяемый текст
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub sc_Symbols_Check(ByRef r_strText As String)

On Error GoTo sc_Symbols_Check_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Dim strTemp As String, lonI As Long, strSymbol As String

    strTemp = "~`|&!@#$%^(){}[]-+/*,.\ "
    
    For lonI = 1 To Len(strTemp)
    
        strSymbol = Mid(strTemp, lonI, 1)
        If InStr(r_strText, strSymbol) > 0 Then r_strText = Replace(r_strText, strSymbol, "")
    
    Next lonI

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

sc_Symbols_Check_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "sc_Symbols_Check", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 07:54:46
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     fn_Check_Array
' Тип:          Function
' Доступ:       Private
' Описание:     Проверка является ли переменная массивом
' Параметр:     varArray {Variant} - Проверяемый массив
' Вернёт:       Boolean - True/False в зависимости массив это или нет
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Function fn_Check_Array(ByVal varArray As Variant) As Boolean

On Error GoTo fn_Check_Array_Error
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
    
    Dim lonTemp As Long

    lonTemp = UBound(varArray)
    
    fn_Check_Array = True

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Function

fn_Check_Array_Error:

fn_Check_Array = False

Err.Clear

End Function
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 08:39:14
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ArrayMark_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора возврата массива
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ArrayMark_Change()

On Error GoTo ArrayMark_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ArrayMark_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ArrayMark_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 08:41:36
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ExitOption_Click
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора выхода из процедуры при ошибке
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ExitOption_Click()

On Error GoTo ExitOption_Click_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ExitOption_Click_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ExitOption_Click", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 08:43:27
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     LoggerOption_Click
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора логирования ошибки
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub LoggerOption_Click()

On Error GoTo LoggerOption_Click_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

LoggerOption_Click_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "LoggerOption_Click", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub

' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.09 09:39:05
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     OptionProperty_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора опции
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub OptionProperty_Change()

On Error GoTo OptionProperty_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    If OptionProperty.Value Then
        
        PropertyFrame.Enabled = True
        PropertyLet.Enabled = True
        PropertyGet.Enabled = True
        Returned.Enabled = True
        ReturnType.Enabled = True
        ArrayMark.Enabled = True
        ArrayMark.Value = False
        ReturnLabel.Enabled = True
        ReturnInfo.Enabled = True
        
    Else
    
        PropertyLet.Enabled = False
        PropertyGet.Enabled = False
        PropertyFrame.Enabled = False
        ReturnType.Value = ""
        ReturnType.Enabled = False
        ArrayMark.Value = False
        ArrayMark.Enabled = False
        Returned.Enabled = False
        ReturnLabel.Enabled = False
        ReturnInfo.Value = ""
        ReturnInfo.Enabled = False
        
    End If
    
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

OptionProperty_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "OptionProperty_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 08:46:52
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ResumeOption_Click
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора продоолжения работы при ошибке
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ResumeOption_Click()

On Error GoTo ResumeOption_Click_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ResumeOption_Click_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ResumeOption_Click", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 08:48:44
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     TitlesLetters_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события изменения метки проверки заглавных букв
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub TitlesLetters_Change()

On Error GoTo TitlesLetters_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

TitlesLetters_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "TitlesLetters_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 08:51:13
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     TypePreFixCheck_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события изменения метки префикса типа процедуры
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub TypePreFixCheck_Change()

On Error GoTo TypePreFixCheck_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

TypePreFixCheck_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "TypePreFixCheck_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:14:08
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     CodeListing_DblClick
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события - двойного клика на поле сгенерированного кода
' Параметр:     msfCancel {MSForms.ReturnBoolean} - ?
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub CodeListing_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

On Error GoTo CodeListing_DblClick_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Dim lCountOfLine As Long, objCodePane As Object, sName As String, strComment As String

    lCountOfLine = Application.VBE.ActiveCodePane.CodeModule.CountOfLines
    Set objCodePane = Application.VBE.ActiveCodePane.CodeModule
    objCodePane.InsertLines lCountOfLine + 1, CodeListing.Caption
    sName = objCodePane.Name
    strComment = "Добавлен метод [" & temp_Name.Caption & "] - " & ProcedureInfo
    Call sc_Module_Comment_Set(objCodePane, strComment)
    
    Unload Me

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

CodeListing_DblClick_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "CodeListing_DblClick", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:17:02
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     CreateParametr_Click
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события нажатия на кнопку "Создать параметр"
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub CreateParametr_Click()

On Error GoTo CreateParametr_Click_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Static OptionMark As Boolean

    If ParametrName.Value = "" Then
    
        InfoWindow.Caption = "Укажите имя параметра!"
        ParametrName.SetFocus
        Exit Sub
        
    ElseIf ParametrType.Value = "" Then
        
        InfoWindow.Caption = "Укажите тип данных параметра!"
        ParametrType.SetFocus
        Exit Sub
        
    ElseIf Not ParametrByRef.Value And Not ParametrByVal.Value Then
    
        InfoWindow.Caption = "Укажите способ передачи параметра!"
        Exit Sub
        
    ElseIf ParametrInfo.Value = "" Then
    
        InfoWindow.Caption = "Введите описание параметра!"
        ParametrInfo.SetFocus
        Exit Sub
        
    ElseIf OptionMark And ParametrValue.Value = "" Then
        
        InfoWindow.Caption = "Введите значение по умолчанию!"
        ParametrValue.SetFocus
        Exit Sub
        
    Else
    
        Dim strParamName As String, strOptionStart As String, strOptionEnd As String, strSendWay As String, strArray As String, _
            strPart1 As String, strPart2 As String, strParametr As String, strTypePreFix As String, strDefault As String
            
        strTypePreFix = ParametrType.Value
        
        If strTypePreFix = "Workbook" Then strTypePreFix = "Wbook"
            
        If strTypePreFix = "Worksheet" Then strTypePreFix = "Wsheet"
    
        strParamName = LCase(Left(strTypePreFix, 3)) & ParametrName.Value
        
        strOptionStart = ""
        strOptionEnd = ""
        
        If ParametrValue.Value <> "" Then
            OptionMark = True
            strOptionStart = "Optional "
            Select Case ParametrType.Value
            
                Case "Boolean", "Long", "Iteger", "Single"
                    strOptionEnd = ParametrValue.Value
                
                Case Else
                    strOptionEnd = Chr(34) & ParametrValue.Value & Chr(34)
                    
            End Select
            
            strDefault = "; По умолчанию: " & strOptionEnd
            strParamName = "o_" & strParamName
            ParametrByVal.Value = True
        End If
    
        If ParametrByRef.Value Then strSendWay = "ByRef"
        If ParametrByVal.Value Then strSendWay = "ByVal"
        
        strArray = ""
        
        If ParametrArrayMark.Value Then strArray = "()": strSendWay = "ByRef"
        
        If strSendWay = "ByRef" Then strParamName = "r_" & strParamName
        
        strPart1 = strSendWay & " " & strParamName & strArray & " As " & ParametrType.Value
        strPart2 = strParamName & strArray & " {" & ParametrType.Value & "} - " & ParametrInfo.Value
        
        strParametr$ = IIf(OptionMark, strOptionStart & strPart1 & " = " & strOptionEnd & " | " & strPart2 & strDefault, strPart1 & " | " & strPart2)
        
        ParametrsInd = ParametrsInd + 1
        ReDim Preserve Parametrs(1 To ParametrsInd) As String
        Parametrs(ParametrsInd) = strParametr
        
        ParametrName.Value = ""
        ParametrType.Value = ""
        ParametrInfo.Value = ""
        ParametrValue.Value = ""
        ParametrArrayMark.Value = False
        ParametrByRef.Value = False
        ParametrByVal.Value = False
        
    End If
    
    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

CreateParametr_Click_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "CreateParametr_Click", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:23:26
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ErrorHandlerMark_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события изменения метки обработки ошибок
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ErrorHandlerMark_Change()

On Error GoTo ErrorHandlerMark_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    If ErrorHandlerMark Then
        ErrorFrame.Enabled = True
        ExitOption.Enabled = True
        LoggerOption.Enabled = True
        LoggerOption.Value = True
        ResumeOption.Enabled = True
    Else
        ErrorFrame.Enabled = False
        ExitOption.Enabled = False
        LoggerOption.Enabled = False
        ResumeOption.Enabled = False
    End If
    
    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ErrorHandlerMark_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ErrorHandlerMark_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:24:59
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     OptionFunction_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора типа "Функция"
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub OptionFunction_Change()

On Error GoTo OptionFunction_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    If OptionFunction.Value Then

        Returned.Enabled = True
        ReturnType.Enabled = True
        ArrayMark.Enabled = True
        ArrayMark.Value = False
        ReturnLabel.Enabled = True
        ReturnInfo.Enabled = True
        PropertyFrame.Enabled = False
        PropertyLet.Enabled = False
        PropertyGet.Enabled = False
        
    Else
    
        ReturnType.Value = ""
        ReturnType.Enabled = False
        ArrayMark.Value = False
        ArrayMark.Enabled = False
        Returned.Enabled = False
        ReturnLabel.Enabled = False
        ReturnInfo.Value = ""
        ReturnInfo.Enabled = False
        
    End If
    
    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

OptionFunction_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "OptionFunction_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:27:36
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ParametrArrayMark_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события изменения метки массива Параметра
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ParametrArrayMark_Change()

On Error GoTo ParametrArrayMark_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    If ParametrArrayMark Then ParametrByRef.Value = True

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ParametrArrayMark_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ParametrArrayMark_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:29:00
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ParametrByVal_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора пердачи парметра по значению
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ParametrByVal_Change()

On Error GoTo ParametrByVal_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    If ParametrByVal.Value Then ParametrArrayMark.Value = False

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ParametrByVal_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ParametrByVal_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:30:42
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     OptionPrivate_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора уровня доступа "Private"
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub OptionPrivate_Change()

On Error GoTo OptionPrivate_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

OptionPrivate_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "OptionPrivate_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:32:35
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     OptionPublic_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора уровня доступа "Public"
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub OptionPublic_Change()

On Error GoTo OptionPublic_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

OptionPublic_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "OptionPublic_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:36:50
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     OptionSub_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора типа создаваемого метода = "Sub"
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub OptionSub_Change()

On Error GoTo OptionSub_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

OptionSub_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "OptionSub_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:38:42
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ParametrName_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события изменения имени создаваемого параметра метода
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ParametrName_Change()

On Error GoTo ParametrName_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Dim strTemp As String: strTemp = ParametrName.Value

    Call sc_Symbols_Check(strTemp)
    
    ParametrName.Value = WorksheetFunction.Proper(strTemp)

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ParametrName_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ParametrName_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:41:50
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     PatternChoice_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора шаблона кода
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub PatternChoice_Change()

On Error GoTo PatternChoice_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    If PatternChoice.Value = "Refresh Table" Then
        OptionFunction.Value = True
        ReturnType.Value = "Boolean"
        ReturnInfo.Value = "True/False в зависимости от того удалось обновить таблицу или нет"
    End If
    
    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

PatternChoice_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "PatternChoice_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:48:22
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ProcedureInfo_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события изменения описания к создаваемому методу
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ProcedureInfo_Change()

On Error GoTo ProcedureInfo_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ProcedureInfo_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ProcedureInfo_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:50:13
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ProcedureName_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Процедура обработки события изменения имени создаваемой процедуры
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ProcedureName_Change()

On Error GoTo ProcedureName_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Dim strText As String: strText = ProcedureName.Value
    If IsNumeric(Left(strText, 1)) Then strText = Right(strText, Len(strText) - 1)
    If TitlesLetters Then strText = WorksheetFunction.Proper(strText)
    Call sc_Symbols_Check(strText)
    ProcedureName.Value = strText
    
    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ProcedureName_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ProcedureName_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:52:40
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ReturnInfo_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события изменения описания к возвращзаемому значению
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ReturnInfo_Change()

On Error GoTo ReturnInfo_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызов метода генерации методов

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ReturnInfo_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ReturnInfo_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:56:26
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ReturnType_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка изменения типа возвращаемого значения
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ReturnType_Change()

On Error GoTo ReturnType_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ReturnType_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ReturnType_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 09:58:37
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     ScreenUpdatingMark_Change
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события выбора метки обновления экрана
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub ScreenUpdatingMark_Change()

On Error GoTo ScreenUpdatingMark_Change_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

ScreenUpdatingMark_Change_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "ScreenUpdatingMark_Change", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 10:01:10
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     UserForm_Activate
' Тип:          Sub
' Доступ:       Private
' Описание:     Обработка события активации формы генерации методов
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub UserForm_Activate()

On Error GoTo UserForm_Activate_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    Dim lonI As Long, DataTypes() As Variant
    DataTypes = fn_Types()

    For lonI = LBound(DataTypes) To UBound(DataTypes)
    
        If DataTypes(lonI) <> "Range" And DataTypes(lonI) <> "Worksheet" And DataTypes(lonI) <> "Workbook" Then ReturnType.AddItem DataTypes(lonI)
        ParametrType.AddItem DataTypes(lonI)
    
    Next lonI
    
    ReDim Patterns(0) As Variant: Patterns = Array("Refresh Table", "Manupulate Data")
    
    For lonI = LBound(Patterns) To UBound(Patterns)
    
        PatternChoice.AddItem Patterns(lonI)
    
    Next lonI
    
    Erase Parametrs: ParametrsInd = 1
    
    Call sc_Code_Listing_Create ' Вызываем процедуру построения процедуры

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

UserForm_Activate_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "UserForm_Activate", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
' Создано:      2020.04.12 10:04:14
' Создатель:    Шевченко Дмитрий <primalevil@gmail.com>
' Название:     sc_Code_Listing_Create
' Тип:          Sub
' Доступ:       Private
' Описание:     Метод генерации методов
' - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - + - +
Private Sub sc_Code_Listing_Create()

On Error GoTo sc_Code_Listing_Create_Error ' При ошибке переход по метке
' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -

    If ProcedureName.Value = "" Then
    
        InfoWindow.Caption = "Введите название создаваемой процедуры!"
        CodeListing.Caption = ""
        ProcedureName.SetFocus
        Exit Sub
        
    ElseIf ProcedureInfo.Value = "" Then
    
        InfoWindow.Caption = "Введите описание создаваемой процедуры!"
        CodeListing.Caption = ""
        Exit Sub
        
    ElseIf Not OptionFunction.Value And Not OptionSub.Value Then
    
        InfoWindow.Caption = "Выберите тип создаваемой процедуры!"
        CodeListing.Caption = ""
        Exit Sub
        
    ElseIf Not OptionPrivate.Value And Not OptionPublic.Value Then
    
        InfoWindow.Caption = "Выберите модификатор доступа к создаваемой процедуры!"
        CodeListing.Caption = ""
        Exit Sub
        
    ElseIf OptionFunction.Value And ReturnType.Value = "" Then
    
        InfoWindow.Caption = "Выберите данных возвращаемого значения в создаваемой процедуре!"
        CodeListing.Caption = ""
        Exit Sub
        
    ElseIf OptionFunction.Value And ReturnInfo.Value = "" Then
    
        InfoWindow.Caption = "Добавьте описание возвращаемого значения в создаваемой процедуре!"
        CodeListing.Caption = ""
        Exit Sub
        
    Else
    
        Dim strLine1 As String, strLine2 As String, strMode As String, strType As String, _
            strReturn As String, strReturnInfo As String, strStart As String, strParams As String, strParamsInfo As String, lonI As Long, _
            varParams As Variant, strCode As String, strPreFix As String
    
        InfoWindow.Caption = ""
        strLine1 = fn_Code_Line()
        strLine2 = fn_Code_Line(" -  ", 15)
    
        If OptionFunction.Value Or OptionSub.Value Then
        
            If OptionPrivate.Value Then strMode = "Private"
        
            If OptionPublic.Value Then strMode = "Public"
        
            If OptionSub.Value Then strType = "Sub": If TypePreFixCheck Then strPreFix = "sc_"
        
            If OptionFunction.Value Then
                strType$ = "Function"
                If TypePreFixCheck Then strPreFix = "fn_"
                If ReturnType.Value <> "" Then
                    strReturn = " As " & ReturnType.Value
                    If ArrayMark Then strReturn = strReturn & "()"
                End If
                If ReturnInfo.Value <> "" Then
                    strReturnInfo = IIf(ArrayMark, "' Вернёт:       " & ReturnType.Value & "() - " & ReturnInfo.Value, "' Вернёт:       " & ReturnType.Value & " - " & ReturnInfo.Value)
                End If
            End If
        
            temp_Name.Caption = strPreFix & ProcedureName.Value
            strStart = strMode & " " & strType & " " & temp_Name.Caption
            strParams = "("
            strParamsInfo = ""
        
            If fn_Check_Array(Parametrs) Then
        
                For lonI = LBound(Parametrs) To UBound(Parametrs)
        
                    If Parametrs(lonI) <> "" Then
                        varParams = Split(Parametrs(lonI), " | ")
                        strParams = IIf(strParams = "(", strParams & varParams(0), strParams & ", _" & vbNewLine & Globals.fn_Add_Symbols(varParams(0), Len(strStart) + Len(varParams(0)) + 1, " "))
                        strParamsInfo = IIf(strParamsInfo = "", vbNewLine & "' Параметр:     " & varParams(1), strParamsInfo & vbNewLine & "' Параметр:     " & varParams(1))
                    End If
        
                Next lonI
        
            End If
        
            strParams = strParams & ")"
        
            strCode = strLine1
            
            Call sc_VBA_Add_Line(strCode, "' Создано:      " & Format(Now(), "yyyy.mm.dd hh:mm:ss"))
            Call sc_VBA_Add_Line(strCode, "' Создатель:    " & Shevchenko_AddIn.AUTOR)
            Call sc_VBA_Add_Line(strCode, "' Название:     " & temp_Name.Caption)
            Call sc_VBA_Add_Line(strCode, "' Тип:          " & strType)
            Call sc_VBA_Add_Line(strCode, "' Доступ:       " & strMode)
            Call sc_VBA_Add_Line(strCode, "' Описание:     " & ProcedureInfo)
            If strParamsInfo <> "" Then Call sc_VBA_Add_Line(strCode, strParamsInfo, False)
            If ReturnInfo.Value <> "" Then Call sc_VBA_Add_Line(strCode, strReturnInfo)
            Call sc_VBA_Add_Line(strCode, strLine1)
            Call sc_VBA_Add_Line(strCode, strStart)
            Call sc_VBA_Add_Line(strCode, strParams, False)
            If OptionFunction.Value Then Call sc_VBA_Add_Line(strCode, strReturn, False)
        
            If ErrorHandlerMark Then
        
                If ExitOption Then Call sc_VBA_Add_Line(strCode, vbNewLine & "On Error Resume Next: Err.Clear :Exit " & strType & " ' Выход из процедуры")
                
                If ResumeOption Then Call sc_VBA_Add_Line(strCode, vbNewLine & "On Error Resume Next: Err.clear ' Игнорирование ошибки")
                
                If LoggerOption Then Call sc_VBA_Add_Line(strCode, vbNewLine & "On Error GoTo " & strPreFix & ProcedureName.Value & "_Error ' При ошибке переход по метке")
        
            End If
        
            If ScreenUpdatingMark Then Call sc_VBA_Add_Line(strCode, vbNewLine & "Call Globals.sc_Screen_Updating(False) ' Выключаем обновление экрана")
        
            Call sc_VBA_Add_Line(strCode, strLine2)
        
            Select Case PatternChoice.Value
        
                Case "Refresh Table"
                    Call sc_Pattern_Refresh_Table(strCode)
                        
                Case "Manupulate Data"
                    Call sc_Pattern_Manupulate_Data(strCode)
        
                Case Else
                    Call sc_VBA_Add_Line(strCode, vbNewLine & vbTab & "' Поместите сюда свой код")
        
            End Select
        
            Call sc_VBA_Add_Line(strCode, vbNewLine & strLine2)
        
            If ScreenUpdatingMark Then Call sc_VBA_Add_Line(strCode, "Call Globals.sc_Screen_Updating(True) ' Выключаем обновление экрана" & vbNewLine)
        
            If ErrorHandlerMark Then
        
                If LoggerOption Then
        
                    Call sc_VBA_Add_Line(strCode, "Exit " & strType & " ' Завершение работы")
                    Call sc_VBA_Add_Line(strCode, vbNewLine & temp_Name.Caption & "_Error: ' Инструкции что делать при ошибке")
                    Call sc_VBA_Add_Line(strCode, vbNewLine & "Call Globals.sc_Error_Logger (Err, " & Chr(34) & Application.VBE.ActiveCodePane.CodeModule.Parent.Name & Chr(34) & ", " & Chr(34) & temp_Name.Caption & Chr(34) & ", MODULEVERSION) ' Вызов обработчика ошибок")
        
                End If
        
            End If
    
        Call sc_VBA_Add_Line(strCode, vbNewLine & "End " & strType)
        
        ElseIf OptionProperty.Value Then
            
            '
            
        End If
    
        CodeListing.Caption = strCode
        
        
    End If

' -   -   -   -   -   -   -   -   -   -   -   -   -   -   -
Exit Sub ' Завершение работы

sc_Code_Listing_Create_Error: ' Инструкции что делать при ошибке

Call Globals.sc_Error_Logger(Err, "ProcedureBilder", "sc_Code_Listing_Create", MODULEVERSION)  ' Вызов обработчика ошибок

End Sub
