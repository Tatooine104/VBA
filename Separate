Public Sub separate2()

Application.ScreenUpdating = False

Dim r As Long, c As Long, cou As Long, incol As Long, col As Long, val As Long, del As Long, delc As Long

delc = 0
r = ActiveCell.Row
c = ActiveCell.Column
incol = Application.InputBox(prompt:="Укажите максимальный размер столбцов", Title:="Разбивка на столбцы", Type:=1)
If incol = o Then Exit Sub
Range(Selection, Selection.End(xlDown)).Select
cou = Selection.Rows.Count
col = WorksheetFunction.RoundUp(cou / incol, 0)
val = Int(cou / col)
del = cou - val * col

Do

If Cells(ActiveCell.Row + val, ActiveCell.Column) <> "" Then
    r = ActiveCell.Row
    c = ActiveCell.Column

    If delc < del Then
        Application.GoTo Reference:="R" & r + val + 1 & "C" & c
    Else
        Application.GoTo Reference:="R" & r + val & "C" & c
    End If
    
    If Cells(ActiveCell.Row + 1, ActiveCell.Column) <> "" Then Range(Selection, Selection.End(xlDown)).Select
    
    Selection.Cut
    Cells(r, c + 1).Select
    ActiveSheet.Paste
    delc = delc + 1
    
End If

Loop Until Cells(r + val, c + 1) = ""

Application.ScreenUpdating = True

End Sub
